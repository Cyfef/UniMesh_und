# UniMesh_und

## Environment

```
conda create -n reflexion python=3.11 -y
conda activate reflexion

cd Reflexion
pip install -r requirements.txt
```

## Models

```
# Bagel
from huggingface_hub import snapshot_download

save_dir = "./Reflexion/LMs/Bagel/models/ByteDance-Seed/BAGEL-7B-MoT"
repo_id = "ByteDance-Seed/BAGEL-7B-MoT"
cache_dir = save_dir + "/cache"

snapshot_download(
  cache_dir=cache_dir,
  local_dir=save_dir,
  repo_id=repo_id,
  local_dir_use_symlinks=False,
  resume_download=True,
  )
```

```
# Qwen2.5-VL-3B-Instruct
from huggingface_hub import snapshot_download

save_dir = "./Reflexion/LMs/Qwen2_5/models/Qwen/Qwen2.5-VL-3B-Instruct"
repo_id = "Qwen/Qwen2.5-VL-3B-Instruct"
cache_dir = save_dir + "/cache"

snapshot_download(
  cache_dir=cache_dir,
  local_dir=save_dir,
  repo_id=repo_id,
  local_dir_use_symlinks=False,
  resume_download=True,
  )
```

```
# Qwen3-VL-8B-Instruct
from huggingface_hub import snapshot_download

save_dir = "./Reflexion/LMs/Qwen3/models/Qwen/Qwen3-VL-8B-Instruct"
repo_id = "Qwen/Qwen3-VL-8B-Instruct"
cache_dir = save_dir + "/cache"

snapshot_download(
  cache_dir=cache_dir,
  local_dir=save_dir,
  repo_id=repo_id,
  local_dir_use_symlinks=False,
  resume_download=True,
  )

```

## Run

```
python reflexion.py
```

<details>
<summary><span style="font-weight: bold;">Command Line Arguments for reflexion.py</span></summary>

#### --n
Max number of trials for an agent (```3``` by default).

#### --prompt
Prompt string for captioning task (```CAPTION_PROMPT``` by default).

#### --strategy
Reflexion running strategy .
| Choice | Function | 
| :--- | :--- |  
| **```'base'```** | No reflection | 
| **```'last_trial'```** | Use last reasoning trace in context | 
| **```'reflexion'```** | Apply reflexion to the next reasoning trace | 
| **```'last_trial_and_reflexion'```(by default)** | Use last reasoning trace in context and apply reflexion to the next reasoning trace |

#### --Evaluator
Model choice for evaluator
| Choice | Function | 
| :--- | :--- |  
| **```'Bagel'```(by default)** | Use Bagel as Evaluator model | 
| **```'Qwen2.5-VL-3B'```** | Use Qwen2.5-VL-3B as Evaluator model | 
| **```'Qwen3-VL-8B'```** | Use Qwen3-VL-8B as Evaluator model | 

#### --objs_dir
Path where the renderings of the objects are stored (```"../data/Cap3D_imgs"``` by default).

#### --save_dir
Path where the captions generated by Reflexion should be stored (```"../Captions"``` by default).

          
</details>
<br>

